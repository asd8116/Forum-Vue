{"version":3,"sources":["webpack:///./src/components/admin/AdminNav.vue?6f26","webpack:///./src/components/admin/AdminNav.vue","webpack:///./src/views/admin/AdminUsers.vue?f55f","webpack:///src/views/admin/AdminUsers.vue","webpack:///./src/views/admin/AdminUsers.vue?4901","webpack:///./src/views/admin/AdminUsers.vue","webpack:///./src/apis/admin.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","to","staticRenderFns","script","component","Object","componentNormalizer","__webpack_exports__","scope","width","_l","user","key","id","_s","email","isAdmin","currentUser","type","on","click","$event","toggleUserRole","userId","_e","AdminUsersvue_type_script_lang_js_","data","users","isLoading","computed","_objectSpread","vuex_esm","created","fetchUser","methods","_fetchUser","asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","statusText","wrap","_context","prev","next","admin","get","sent","Error","t0","helpers","fire","title","stop","apply","arguments","_toggleUserRole","_callee2","_ref2","willBeAdmin","_ref3","_context2","update","toString","status","map","_x","components","AdminNav","Spinner","admin_AdminUsersvue_type_script_lang_js_","restaurants","apiHelper","create","formData","post","delete","restaurantId","concat","getDetail","_ref4","put","categories","_ref5","name","_ref6","categoryId","_ref7","_ref8"],"mappings":"kHAAA,IAAAA,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,QAAmB,CAAAF,EAAA,MAAAJ,EAAAO,GAAA,UAAAH,EAAA,eAA8CI,MAAA,CAAOC,GAAA,uBAA2B,CAAAT,EAAAO,GAAA,iBAAAP,EAAAO,GAAA,UAAAH,EAAA,eAA6DI,MAAA,CAAOC,GAAA,sBAA0B,CAAAT,EAAAO,GAAA,gBAAAP,EAAAO,GAAA,UAAAH,EAAA,eAA4DI,MAAA,CAAOC,GAAA,iBAAqB,CAAAT,EAAAO,GAAA,gBACnYG,EAAA,eCAAC,EAAA,GAKAC,EAAgBC,OAAAC,EAAA,KAAAD,CAChBF,EACEZ,EACAW,GACF,EACA,KACA,KACA,MAIeK,EAAA,KAAAH,sDCjBf,IAAAb,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,kBAA6B,CAAAF,EAAA,YAAAJ,EAAA,UAAAI,EAAA,WAAAA,EAAA,SAA2DE,YAAA,SAAoB,CAAAF,EAAA,SAAcE,YAAA,cAAyB,CAAAF,EAAA,MAAAA,EAAA,MAAoBI,MAAA,CAAOQ,MAAA,QAAe,CAAAhB,EAAAO,GAAA,OAAAH,EAAA,MAAyBI,MAAA,CAAOQ,MAAA,QAAe,CAAAhB,EAAAO,GAAA,WAAAH,EAAA,MAA6BI,MAAA,CAAOQ,MAAA,QAAe,CAAAhB,EAAAO,GAAA,UAAAH,EAAA,MAA4BI,MAAA,CAAOQ,MAAA,MAAAC,MAAA,QAA6B,CAAAjB,EAAAO,GAAA,gBAAAH,EAAA,QAAAJ,EAAAkB,GAAAlB,EAAA,eAAAmB,GAAsE,OAAAf,EAAA,MAAgBgB,IAAAD,EAAAE,IAAY,CAAAjB,EAAA,MAAWI,MAAA,CAAOQ,MAAA,QAAe,CAAAhB,EAAAO,GAAAP,EAAAsB,GAAAH,EAAAE,OAAAjB,EAAA,MAAAJ,EAAAO,GAAAP,EAAAsB,GAAAH,EAAAI,UAAAnB,EAAA,MAAAJ,EAAAO,GAAAP,EAAAsB,GAAAH,EAAAK,QAAA,mBAAApB,EAAA,MAAAJ,EAAAyB,YAAAJ,KAAAF,EAAAE,GAAAjB,EAAA,UAAoLE,YAAA,eAAAE,MAAA,CAAkCkB,KAAA,UAAgBC,GAAA,CAAKC,MAAA,SAAAC,GAAyB,OAAA7B,EAAA8B,eAAA,CAA2BC,OAAAZ,EAAAE,GAAAG,QAAAL,EAAAK,aAA2C,CAAAxB,EAAAO,GAAAP,EAAAsB,GAAAH,EAAAK,QAAA,iCAAAxB,EAAAgC,WAA+E,UACr+BtB,EAAA,isBCyCA,IAAAuB,EAAA,CACAC,KADA,WAEA,OACAC,MAAA,GACAC,WAAA,IAGAC,SAAAC,EAAA,GACAzB,OAAA0B,EAAA,KAAA1B,CAAA,kBAEA2B,QAVA,WAWAvC,KAAAwC,aAEAC,QAAA,CACAD,UADA,eAAAE,EAAA9B,OAAA+B,EAAA,KAAA/B,CAAAgC,mBAAAC,KAAA,SAAAC,IAAA,IAAAC,EAAAd,EAAAe,EAAA,OAAAJ,mBAAAK,KAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGAC,EAAA,KAAAnB,MAAAoB,MAHA,UAAAP,EAAAG,EAAAK,KAGAtB,EAHAc,EAGAd,KAAAe,EAHAD,EAGAC,WAEA,OAAAA,EALA,CAAAE,EAAAE,KAAA,cAMA,IAAAI,MAAAR,GANA,OASAhD,KAAAkC,MAAAD,EAAAC,MACAlC,KAAAmC,WAAA,EAVAe,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAO,GAAAP,EAAA,YAYAlD,KAAAmC,WAAA,EACAuB,EAAA,KAAAC,KAAA,CACAlC,KAAA,QACAmC,MAAA,mBAfA,yBAAAV,EAAAW,SAAAf,EAAA9C,KAAA,sBAAAwC,IAAA,OAAAE,EAAAoB,MAAA9D,KAAA+D,WAAA,OAAAvB,EAAA,GAmBAX,eAnBA,eAAAmC,EAAApD,OAAA+B,EAAA,KAAA/B,CAAAgC,mBAAAC,KAAA,SAAAoB,EAAAC,GAAA,IAAApC,EAAAP,EAAA4C,EAAAC,EAAAnC,EAAAe,EAAA,OAAAJ,mBAAAK,KAAA,SAAAoB,GAAA,eAAAA,EAAAlB,KAAAkB,EAAAjB,MAAA,cAmBAtB,EAnBAoC,EAmBApC,OAAAP,EAnBA2C,EAmBA3C,QAnBA8C,EAAAlB,KAAA,EAqBAgB,GAAA5C,EArBA8C,EAAAjB,KAAA,EAsBAC,EAAA,KAAAnB,MAAAoC,OAAA,CACAxC,SACAP,QAAA4C,EAAAI,aAxBA,UAAAH,EAAAC,EAAAd,KAsBAtB,EAtBAmC,EAsBAnC,KAAAe,EAtBAoB,EAsBApB,WAKA,OAAAA,GAAA,YAAAf,EAAAuC,OA3BA,CAAAH,EAAAjB,KAAA,eA4BA,IAAAI,MAAAR,GA5BA,QA+BAhD,KAAAkC,MAAAlC,KAAAkC,MAAAuC,IAAA,SAAAvD,GACA,OAAAA,EAAAE,KAAAU,EACAZ,EAGAmB,EAAA,GACAnB,EADA,CAEAK,QAAA4C,MAtCAE,EAAAjB,KAAA,iBAAAiB,EAAAlB,KAAA,GAAAkB,EAAAZ,GAAAY,EAAA,YA0CAX,EAAA,KAAAC,KAAA,CACAlC,KAAA,QACAmC,MAAA,mBA5CA,yBAAAS,EAAAR,SAAAI,EAAAjE,KAAA,sBAAA6B,EAAA6C,GAAA,OAAAV,EAAAF,MAAA9D,KAAA+D,WAAA,OAAAlC,EAAA,IAiDA8C,WAAA,CACAC,WAAA,KACAC,UAAA,OC1GmWC,EAAA,cCOnWnE,EAAgBC,OAAAC,EAAA,KAAAD,CACdkE,EACAhF,EACAW,GACF,EACA,KACA,KACA,MAIeK,EAAA,WAAAH,uEChBAG,EAAA,MACbiE,YAAa,CACXzB,IADW,WAET,OAAO0B,OAAU1B,IAAI,uBAEvB2B,OAJW,SAAAlC,GAIU,IAAZmC,EAAYnC,EAAZmC,SACP,OAAOF,OAAUG,KAAK,qBAAsBD,IAE9CE,OAPW,SAAAlB,GAOc,IAAhBmB,EAAgBnB,EAAhBmB,aACP,OAAOL,OAAUI,OAAV,sBAAAE,OAAuCD,KAEhDE,UAVW,SAAAnB,GAUiB,IAAhBiB,EAAgBjB,EAAhBiB,aACV,OAAOL,OAAU1B,IAAV,sBAAAgC,OAAoCD,KAE7Cf,OAbW,SAAAkB,GAawB,IAA1BH,EAA0BG,EAA1BH,aAAcH,EAAYM,EAAZN,SACrB,OAAOF,OAAUS,IAAV,sBAAAH,OAAoCD,GAAgBH,KAG/DQ,WAAY,CACVpC,IADU,WAER,OAAO0B,OAAU1B,IAAI,sBAEvB2B,OAJU,SAAAU,GAIO,IAARC,EAAQD,EAARC,KACP,OAAOZ,OAAUG,KAAK,oBAAqB,CAAES,UAE/CtB,OAPU,SAAAuB,GAOmB,IAApBC,EAAoBD,EAApBC,WAAYF,EAAQC,EAARD,KACnB,OAAOZ,OAAUS,IAAV,qBAAAH,OAAmCQ,GAAc,CAAEF,UAE5DR,OAVU,SAAAW,GAUa,IAAdD,EAAcC,EAAdD,WACP,OAAOd,OAAUI,OAAV,qBAAAE,OAAsCQ,MAGjD5D,MAAO,CACLoB,IADK,WAEH,OAAO0B,OAAU1B,IAAI,iBAEvBgB,OAJK,SAAA0B,GAIuB,IAAnBlE,EAAmBkE,EAAnBlE,OAAQP,EAAWyE,EAAXzE,QACf,OAAOyD,OAAUS,IAAV,gBAAAH,OAA8BxD,GAAU,CAAEP","file":"js/chunk-ee32eb08.bc54f5e5.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mb-3\"},[_c('h1',[_vm._v(\"餐廳後台\")]),_c('router-link',{attrs:{\"to\":\"/admin/restaurants\"}},[_vm._v(\"Restaurants\")]),_vm._v(\" |\\n  \"),_c('router-link',{attrs:{\"to\":\"/admin/categories\"}},[_vm._v(\"Categories\")]),_vm._v(\" |\\n  \"),_c('router-link',{attrs:{\"to\":\"/admin/users\"}},[_vm._v(\"Users\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AdminNav.vue?vue&type=template&id=041d36b1&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5\"},[_c('AdminNav'),(_vm.isLoading)?_c('Spinner'):_c('table',{staticClass:\"table\"},[_c('thead',{staticClass:\"thead-dark\"},[_c('tr',[_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"Email\")]),_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"Role\")]),_c('th',{attrs:{\"scope\":\"col\",\"width\":\"140\"}},[_vm._v(\"Action\")])])]),_c('tbody',_vm._l((_vm.users),function(user){return _c('tr',{key:user.id},[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(_vm._s(user.id))]),_c('td',[_vm._v(_vm._s(user.email))]),_c('td',[_vm._v(_vm._s(user.isAdmin ? 'admin' : 'user'))]),_c('td',[(_vm.currentUser.id !== user.id)?_c('button',{staticClass:\"btn btn-link\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.toggleUserRole({userId: user.id, isAdmin: user.isAdmin})}}},[_vm._v(_vm._s(user.isAdmin ? 'set as user' : 'set as admin'))]):_vm._e()])])}),0)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container py-5\">\r\n    <AdminNav />\r\n    <Spinner v-if=\"isLoading\" />\r\n    <table v-else class=\"table\">\r\n      <thead class=\"thead-dark\">\r\n        <tr>\r\n          <th scope=\"col\">#</th>\r\n          <th scope=\"col\">Email</th>\r\n          <th scope=\"col\">Role</th>\r\n          <th scope=\"col\" width=\"140\">Action</th>\r\n        </tr>\r\n      </thead>\r\n\r\n      <tbody>\r\n        <tr v-for=\"user in users\" :key=\"user.id\">\r\n          <th scope=\"row\">{{ user.id }}</th>\r\n          <td>{{ user.email }}</td>\r\n          <td>{{ user.isAdmin ? 'admin' : 'user' }}</td>\r\n\r\n          <td>\r\n            <button\r\n              v-if=\"currentUser.id !== user.id\"\r\n              type=\"button\"\r\n              class=\"btn btn-link\"\r\n              @click=\"toggleUserRole({userId: user.id, isAdmin: user.isAdmin})\"\r\n            >{{ user.isAdmin ? 'set as user' : 'set as admin' }}</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport AdminNav from '@/components/admin/AdminNav'\r\nimport Spinner from '@/components/Spinner'\r\n\r\nimport adminAPI from '@/apis/admin'\r\nimport { Toast } from '@/utils/helpers'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      users: [],\r\n      isLoading: true\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['currentUser'])\r\n  },\r\n  created() {\r\n    this.fetchUser()\r\n  },\r\n  methods: {\r\n    async fetchUser() {\r\n      try {\r\n        const { data, statusText } = await adminAPI.users.get()\r\n\r\n        if (statusText !== 'OK') {\r\n          throw new Error(statusText)\r\n        }\r\n\r\n        this.users = data.users\r\n        this.isLoading = false\r\n      } catch (error) {\r\n        this.isLoading = false\r\n        Toast.fire({\r\n          type: 'error',\r\n          title: '無法取得會員資料，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async toggleUserRole({ userId, isAdmin }) {\r\n      try {\r\n        const willBeAdmin = !isAdmin\r\n        const { data, statusText } = await adminAPI.users.update({\r\n          userId,\r\n          isAdmin: willBeAdmin.toString()\r\n        })\r\n\r\n        if (statusText !== 'OK' || data.status !== 'success') {\r\n          throw new Error(statusText)\r\n        }\r\n\r\n        this.users = this.users.map(user => {\r\n          if (user.id !== userId) {\r\n            return user\r\n          }\r\n\r\n          return {\r\n            ...user,\r\n            isAdmin: willBeAdmin\r\n          }\r\n        })\r\n      } catch (error) {\r\n        Toast.fire({\r\n          type: 'error',\r\n          title: '無法更新會員角色，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    AdminNav,\r\n    Spinner\r\n  }\r\n}\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUsers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUsers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminUsers.vue?vue&type=template&id=59845d68&\"\nimport script from \"./AdminUsers.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminUsers.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { apiHelper } from '@/utils/helpers'\r\n\r\nexport default {\r\n  restaurants: {\r\n    get() {\r\n      return apiHelper.get('/admin/restaurants')\r\n    },\r\n    create({ formData }) {\r\n      return apiHelper.post('/admin/restaurants', formData)\r\n    },\r\n    delete({ restaurantId }) {\r\n      return apiHelper.delete(`/admin/restaurants/${restaurantId}`)\r\n    },\r\n    getDetail({ restaurantId }) {\r\n      return apiHelper.get(`/admin/restaurants/${restaurantId}`)\r\n    },\r\n    update({ restaurantId, formData }) {\r\n      return apiHelper.put(`/admin/restaurants/${restaurantId}`, formData)\r\n    }\r\n  },\r\n  categories: {\r\n    get() {\r\n      return apiHelper.get('/admin/categories')\r\n    },\r\n    create({ name }) {\r\n      return apiHelper.post('/admin/categories', { name })\r\n    },\r\n    update({ categoryId, name }) {\r\n      return apiHelper.put(`/admin/categories/${categoryId}`, { name })\r\n    },\r\n    delete({ categoryId }) {\r\n      return apiHelper.delete(`/admin/categories/${categoryId}`)\r\n    }\r\n  },\r\n  users: {\r\n    get() {\r\n      return apiHelper.get('/admin/users')\r\n    },\r\n    update({ userId, isAdmin }) {\r\n      return apiHelper.put(`/admin/users/${userId}`, { isAdmin })\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":""}